/*
FASHION: Style + Smarts ------------------------------------------------------
Copyright (c) 2014 Keaton Brandt
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
------------------------------------------------------------------------------
 */
!function(){var e,t;e=window.fashion={version:"0.2",url:"http://writefashion.org",author:"Keaton Brandt",mimeType:"text/x-fashion",cssId:"FASHION-stylesheet",runtimeObject:"FASHION",runtimeModules:["watchVariables"]},window.fashion.runtimeConfig={variableObject:"style",idPrefix:"FS-",individualCSSID:"FASHION-individual",cssId:window.fashion.cssId},t=function(e,t){return setTimeout(t,e)},window.fashion.addProperty=function(e,t,n){return null==n&&(n=!1),t instanceof f||(t=new f(t)),!n&&window.fashion.$properties[e]?new Error("There is already a property named "+e):window.fashion.$properties[e]=t},window.fashion.addProperties=function(e,t){var n,i,r,o,a;for(null==t&&(t=!1),a=[],i=r=0,o=e.length;o>r;i=++r)n=e[i],a.push(window.fashion.addProperty(n,i,t));return a},window.fashion.addFunction=function(e,t,n){return null==n&&(n=!1),t instanceof c||(t=new c(t)),!n&&window.fashion.$functions[e]?new Error("There is already a function named "+e):window.fashion.$functions[e]=t},window.fashion.addFunctions=function(e,t){var n,i,r,o,a;for(null==t&&(t=!1),a=[],i=r=0,o=e.length;o>r;i=++r)n=e[i],a.push(window.fashion.addFunction(n,i,t));return a},window.fashion.addGlobal=function(e,t,n){return null==n&&(n=!1),t instanceof p||(t=new p(t)),!n&&window.fashion.$globals[e]?new Error("There is already a global named "+e):window.fashion.$globals[e]=t},window.fashion.addGlobals=function(e,t){var n,i,r,o,a;for(null==t&&(t=!1),a=[],i=r=0,o=e.length;o>r;i=++r)n=e[i],a.push(window.fashion.addGlobal(n,i,t));return a},window.fashion.addBlock=function(e,t,n){return null==n&&(n=!1),t instanceof d||(t=new d(t)),!n&&window.fashion.$blocks[e]?new Error("There is already a block named "+e):window.fashion.$blocks[e]=t},window.fashion.addBlocks=function(e,t){var n,i,r,o,a;for(null==t&&(t=!1),a=[],i=r=0,o=e.length;o>r;i=++r)n=e[i],a.push(window.fashion.addBlock(n,i,t));return a},window.fashion.live={loadedEvent:"fashion-loaded"},document.addEventListener("readystatechange",function(){return"complete"===document.readyState?window.fashion.$loader.loadStyles(function(t){var n,i,r,o,a,s;return a=(new Date).getTime(),o=window.fashion.$parser.parse(t),o=window.fashion.$processor.process(o),s=window.fashion.$actualizer.actualize(o),n=s.css,r=s.js,e.$dom.addStylesheet(n),e.$dom.addScript(r),console.log("[FASHION] Compile finished in "+((new Date).getTime()-a)+"ms"),i=new Event(window.fashion.live.loadedEvent),i.variableObject=window[window.fashion.variableObject],document.dispatchEvent(i)}):void 0});var n=[].slice;window.fashion.$extend=function(e,t){var n,i,r;r=[];for(n in t)i=t[n],r.push(e[n]?void 0:e[n]=i);return r},window.fashion.$combine=function(){var e,t,i,r,o;for(t=1<=arguments.length?n.call(arguments,0):[],i={},r=0,o=t.length;o>r;r++)e=t[r],window.fashion.$extend(i,e);return i},window.fashion.$dom={addElementToHead:function(e){var t;return t=document.head||document.getElementsByTagName("head")[0],t.appendChild(e)},addStylesheet:function(t,n){var i,r,o,a;null==n&&(n=window.fashion.cssId),r=document.createElement("style"),r.setAttribute("type","text/css"),r.setAttribute("id",""+n),e.$dom.addElementToHead(r),o=t.split("\n"),a=[];for(n in o)i=o[n],i.length>3&&a.push(r.sheet.insertRule(i,n));return a},addScript:function(t){var n;return n=document.createElement("script"),n.setAttribute("type","text/javascript"),n.text=t,e.$dom.addElementToHead(n)},incrementSheetIndex:function(e){var t;return t=parseInt(e.getAttribute("data-count")),e.setAttribute("data-count",t+1),t},getSheetIndex:function(e){return parseInt(e.getAttribute("data-index"))}},window.fashion.$stringify=function(e){if(e instanceof Array)return window.fashion.$stringifyArray(e);switch(typeof e){case"string":return JSON.stringify(e);case"object":return window.fashion.$stringifyObject(e);case"number":return e;case"undefined":return"undefined";default:return e.toString()}},window.fashion.$stringifyObject=function(e){var t,n,i;t=[];for(n in e)i=e[n],e.hasOwnProperty(n)&&(n=n.replace("'","'"),t.push("'"+n+"': "+window.fashion.$stringify(i)));return"{"+t.join(",")+"}"},window.fashion.$stringifyArray=function(e){var t,n,i,r;for(t=[],i=0,r=e.length;r>i;i++)n=e[i],t.push(window.fashion.$stringify(n));return"["+t.join(",")+"]"};var i,r=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};i=function(){function e(){this.variables={},this.selectors=[],this.blocks=[],this.scripts=[],this.dependencies={blocks:{},globals:{},functions:{},properties:{}},this.bindings={variables:{},globals:{},dom:[]}}return e.prototype.addVariable=function(e){var t,n;if(n=e.name,delete e.name,t=e.scope||0,delete e.scope,!n)throw new Error("Variables must be named");return this.variables[n]||(this.variables[n]={}),this.variables[n][t]=e,this.bindings.variables[n]=[]},e.prototype.addSelector=function(e){return e.index=this.selectors.length,this.selectors.push(e)},e.prototype.addScript=function(e){return this.scripts.push(e)},e.prototype.addBlock=function(e){return this.blocks.push(e)},e.prototype.addBlockDependency=function(e,t){return this.dependencies.blocks[e]=t},e.prototype.addGlobalDependency=function(e,t){return this.dependencies.globals[e]=t},e.prototype.addFunctionDependency=function(e,t){return this.dependencies.functions[e]=t},e.prototype.addPropertyDependency=function(e,t){return this.dependencies.properties[e]=t},e.prototype.addVariableBinding=function(e,t){if(!this.bindings.variables[t])throw new Error("Variable "+t+" does not exist or cannot be bound.");if(!(r.call(this.bindings.variables[t],e)>=0))return this.bindings.variables[t].push(e)},e.prototype.addGlobalBinding=function(e,t){return this.bindings.globals[t]||(this.bindings.globals[t]=[]),r.call(this.bindings.globals[t],e)>=0?void 0:this.bindings.globals[t].push(e)},e.prototype.addDOMBinding=function(e,t,n,i){return this.bindings.dom.push({watch:[n,i],rel:t,bind:e})},e.prototype.forEachVariable=function(e){var t,n,i,r,o;o=this.variables;for(t in o){i=o[t];for(n in i)if(r=i[n],e.call(r,r,n)===!1)return}},e.prototype.forEachMatchingSelector=function(e,t){var n,i,r,o;for(o=this.selectors,i=0,r=o.length;r>i;i++)if(n=o[i],n.name===e&&t.call(this,n)===!1)return},e}(),window.fashion.$class||(window.fashion.$class={}),window.fashion.$class.ParseTree=i;var o;o=function(){function e(e,t,n){null==n&&(n=0),"$"===e[0]&&(e=e.substr(1)),this.name=e,this.raw=this.value=t,this.scope=n,this.topLevel=0===n}return e.prototype.annotateWithType=function(e,t,n){return this.type=e,this.unit=t,n?this.value=n:void 0},e}(),window.fashion.$class.Variable=o;var a;a=function(){function t(t,n){this.name=t,this.properties=[],this.index=-1,this.mode=n?n:t instanceof l?e.$runtimeMode.dynamic:e.$runtimeMode["static"]}return t.prototype.addToBody=function(e){return this.body||(this.body=""),this.body+=e},t.prototype.addProperty=function(e){return this.body=void 0,this.properties.push(e)},t.prototype.insertProperty=function(e,t){return this.body=void 0,this.properties.splice(t,0,e)},t.prototype.forEachPropertyNamed=function(e,t){var n,i,r,o;for(o=this.properties,i=0,r=o.length;r>i;i++)if(n=o[i],n.name===e&&t.call(this,n)===!1)return},t}(),window.fashion.$class.Selector=a;var s,u;s=function(){function t(t,n,i,r){null==i&&(i=e.$runtimeMode["static"]),this.name=t,this.mode=i,r?"object"!=typeof n?this.value={value:n,transition:r}:(this.value=n,this.value.transition=r):this.value=n}return t.prototype.copyWithName=function(e){return new t(e,this.value,this.mode)},t}(),u=function(){function e(e,t,n){this.easing=e,this.duration=t,this.delay=n}return e}(),window.fashion.$class.Property=s,window.fashion.$class.PropertyTransition=u;var l;l=function(){function e(e,t,n,i){this.script=e.toString(),this.setter=-1!==this.script.indexOf("="),this.mode=i,this.type=t,this.unit=n}return e.prototype.generate=function(){var e;try{return this.evaluate=Function("v","g","f","t","e",this.script)}catch(t){return e=t,console.log("[FASHION] Could not compile script '"+this.script+"'"),console.log(e)}},e}(),window.fashion.$class.Expression=l;var d,c,p,h,f,w,m={}.hasOwnProperty,v=function(e,t){function n(){this.constructor=e}for(var i in t)m.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};h=function(){function t(t){this.mode=t.mode||t.runtimeMode||e.$runtimeMode["static"],this.runtimeCapabilities=t.runtimeCapabilities||t.capabilities,t.watcherFunction&&(!(this.mode|e.$runtimeMode.dynamic)||this.mode|e.$runtimeMode.live?console.log("[FASHION] Static/live modules cannot have watcher functions."):this.watch=t.watcherFunction)}return t}(),w=function(t){function n(t){this.type=t.type||t.output||t.outputType||e.$type.String,this.unit=t.unit||"",this.get=t.get||t.evaluate,n.__super__.constructor.call(this,t)}return v(n,t),n}(h),p=function(e){function t(e){this.watch=e.watch,t.__super__.constructor.call(this,e)}return v(t,e),t}(w),c=function(e){function t(e){void 0!==e.unitFrom&&(this.unitFrom=e.unitFrom,delete e.unit),t.__super__.constructor.call(this,e)}return v(t,e),t}(w),d=function(e){function t(e){"function"==typeof e?this.compile=e:(this.compile=e.compileFunction||e.compile,this.runtimeObject=e.runtimeObject||e.runtime,this.runtimeCapabilities=e.runtimeCapabilities||e.capabilities)}return v(t,e),t}(h),f=function(t){function n(t){"function"==typeof t?this.compile=t:(this.compile=t.compileFunction||t.compile,this.apply=t.applyFunction||t.apply,this.apply&&(t.mode=e.$runtimeMode.individual),this.replace=t.replace||!1,this.runtimeObject=t.runtimeObject||t.runtime,this.mode=t.mode,this.runtimeCapabilities=t.runtimeCapabilities||t.capabilities)}return v(n,t),n}(h),window.fashion.$class||(window.fashion.$class={}),window.fashion.$class.GlobalModule=p,window.fashion.$class.FunctionModule=c,window.fashion.$class.BlockModule=d,window.fashion.$class.PropertyModule=f,window.fashion.$type={None:0,Number:1,String:2,Color:3,KGeneric:100,KDisplay:101,KCenter:102,KListStyle:103,KLineStyle:104,KInset:105,Unknown:255},window.fashion.$unit={Number:{"":!1," ":!1,px:"px",pt:"pt","%":"%",em:"em",ex:"ex",cm:"cm",mm:"mm","in":"in",pt:"pt",pc:"pc",ch:"ch",rem:"rem",vh:"vh",vw:"vw",vmin:"vmin",vmax:"vmax",ms:"ms",s:"s"}},window.fashion.$typeConstants={colors:["aqua","black","blue","fuchsia","gray","green","lime","maroon","navy","olive","purple","red","silver","teal","white","yellow"]},window.fashion.$runtimeMode={"static":0,dynamic:1,scoped:3,individual:7,live:9,generate:function(e,t,n,i){return(e?1:0)|(t?7:0)|(n?9:0)|(i?3:0)}},window.fashion.$loader={loadStyles:function(t){var n,i,r;return i=e.$loader.countScripts(),r=0,n="",e.$loader.loadIndividualStyles(function(e){return n+=e,++r===i?t(n):void 0})},loadIndividualStyles:function(e){return window.fashion.$loader.loadStyleTags(e)},loadStyleTags:function(t){var n,i,r,o,a,s,u;for(i=document.getElementsByTagName("style"),u=[],n=a=0,s=i.length;s>=0?s>a:a>s;n=s>=0?++a:--a)r=i[n].getAttribute("type"),r===window.fashion.mimeType&&(""!==i[n].textContent?u.push(t(i[n].textContent)):""!==i[n].getAttribute("src")?(o=i[n].getAttribute("src"),u.push(e.$loader.loadExternalScript(o,t))):u.push(void 0));return u},countScripts:function(){var e,t,n,i,r,o,a,s,u;for(e=0,i=document.getElementsByTagName("style"),t=o=0,s=i.length;s>=0?s>o:o>s;t=s>=0?++o:--o)r=i[t].getAttribute("type"),r===window.fashion.mimeType&&e++;for(n=document.getElementsByTagName("link"),t=a=0,u=n.length;u>=0?u>a:a>u;t=u>=0?++a:--a)r=n[t].getAttribute("type"),r===window.fashion.mimeType&&e++;return e},loadExternalScript:function(e,t){var n;return n=new XMLHttpRequest,n.onreadystatechange=function(){return 4===n.readyState&&200===n.status?t(n.responseText):n.status>400?console.log("[FASHION] Could not load script: "+e+" ("+n.status+")"):void 0},n.open("GET",e,!0),n.send()}},window.fashion.$parser={parse:function(t){var n,r,o,a;r=new i,r=e.$parser.parseSections(t,r),a=r.selectors;for(n in a)o=a[n],e.$parser.parseSelectorBody(o.body,o,r);return r}},window.fashion.$parser.addVariable=function(t,n,i,r){var a,s,u,d,c,p;if(i=e.$parser.parseSingleValue(i,"$"+n,t),p=new o(n,i,r),t.addVariable(p),i instanceof l)a=i.type,u=i.unit;else{if(c=p.raw||p.value,!c)return;a=window.fashion.$shared.determineType(c,e.$type,e.$typeConstants),d=window.fashion.$shared.getUnit(c,a,e.$type,e.$unit),s=d.value,u=d.unit}return p.annotateWithType(a,u,s)},window.fashion.$parser.splitByTopLevelCommas=function(e){var t,n,i,r,o;for(n=0,t="",r=[],i=/(\(|\)|\,|[^\(\)\,]+)/g;o=i.exec(e);)","!==o[0]||0!==n?("("===o[0]&&n++,")"===o[0]&&n--,t+=o[0]):(r.push(t),t="");return r.push(t),r},window.fashion.$parser.splitByTopLevelSpaces=function(e){var t,n,i,r,o,a,s,u;for(i=0,s=r=n=!1,t="",a=[],o=/([^\(\)\"\'\`\s]*\(|\)|\"|\'|\`|([^\(\)\"\'\`\s]+(\s+[\+\-\/\*\=]\s+|[\+\-\/\*\=]))+[^\(\)\"\'\`\s]+|\s+(\&\&|\|\|)\s+|\s|[^\(\)\"\'\`\s]+)/g;u=o.exec(e);)" "!==u[0]||0!==i||s||r||n?("("===u[0][u[0].length-1]&&i++,")"===u[0]&&i--,"'"!==u[0]||r||n||(s=!s),'"'!==u[0]||s||n||(r=!r),"`"!==u[0]||r||s||(n=!n),t+=u[0]):(a.push(t),t="");return a.push(t),a},window.fashion.$parser.parseSections=function(t,n){var i,r,o,a;for(r=/([\s]*(\$([\w\-]+)\:[\s]*(.*?)\;|\@([\w\-]+)[\s]*(.*?)[\s]*\{|(.*?)[\s]*?\{)|\{|\})/g;(o=r.exec(t))&&!(o.length<8)&&o[0];)o[3]&&o[4]?e.$parser.addVariable(n,o[3],o[4]):o[5]?(a=o.index+o[0].length,i=o[6]?e.$parser.splitByTopLevelSpaces(o[6]):[],n.addBlock({type:o[5],arguments:i,body:window.fashion.$parser.parseBlock(t,r,a)}),n.addBlockDependency(o[5],e.$blocks[o[5]])):o[7]?window.fashion.$parser.parseSelector(n,t,o[7],r,o.index+o[0].length):console.log("There's a problem somewhere in your file. Sorry.");return n},window.fashion.$parser.parseSelector=function(t,n,i,r,o){var a,s,u,l,d;for(l=[e.$parser.createSelector(t,i)],a=1,u=[0];a>0&&(s=r.exec(n));)d=l[u[u.length-1]],d.addToBody(n.substring(o,s.index)),o=s.index+s[0].length,"}"===s[0]?(u.pop(),a--):s[3]&&s[4]?d.addToBody(n.substring(s.index,o)):s[7]&&(i="&"===s[7][0]?d.name+s[7].substr(1):"~"===s[7][0]?d.name+" "+s[7].substr(1):d.name+" > "+s[7],l.push(e.$parser.createSelector(t,i)),u.push(l.length-1),a++);return l},window.fashion.$parser.createSelector=function(t,n){var i,r,o,s,u,d,c,p,h;if(c=new a(n),t.addSelector(c),-1===n.indexOf("$"))return c;for(o=!1,d="return ",s=0,u=/\$([\w\-]+)/g;r=u.exec(n);)r.index>s&&(d+="'"+n.substring(s,r.index)+"'+"),s=r.index+r[0].length,i=e.$parser.expressionExpander.localVariable,h=i(r[1],c.index,t),o|=h.individualized||!1,d+=h.script+"+";return n.length>s&&(d+="'"+n.substr(s)+"'+"),p=d.substr(0,d.length-1),c.mode=e.$runtimeMode.dynamic,c.name=new l(p,e.$type.String,0,!0,o),c.name.generate(),c},window.fashion.$parser.parseBlock=function(e,t,n){var i,r,o;for(i=1,r=n;i>0&&(o=t.exec(e));)r=o.index+o[0].length,"}"===o[0]?i--:"{"===o[0]?i++:o[5]?i++:o[7]&&i++;return e.substring(n,r-1).trim()},window.fashion.$parser.parseSelectorBody=function(t,n,i){var r,o,a,l,d,c,p,h;for(r=n.index,d=/[\s]*(\$?[\w\-\s]*)\:[\s]*(\[([\w\-\$\@]*)[\s]*([\w\-\$\@\%]*)[\s]*([\w\-\$\@\%]*)\]){0,1}[\s]*([^;}\n]*?)[\s]*(!important)?[;}\n]/g,h=[];l=d.exec(t);)c=void 0,l.length<7||(p=e.$parser.parsePropertyValues(l[6],r,i),a=l[1],"$"!==a[0]?(l[3]&&(c=new u(e.$parser.parsePropertyValue(l[3],r,i,!1),e.$parser.parsePropertyValue(l[4],r,i,!1),e.$parser.parsePropertyValue(l[5],r,i,!1))),"!important"===l[7]&&("string"==typeof p&&(p+=" !important"),"object"==typeof p&&(p.important=!0)),o=n.mode|p.mode||0,h.push(n.addProperty(new s(a,p,o,c)))):e.$parser.parseScopedVariable(a,p,l,n.name,i));return h},window.fashion.$parser.parseScopedVariable=function(t,n,i,r,o){if("array"==typeof n&&"array"==typeof n[0])throw new Error("Variable declaration '"+t+"' cannot have comma separated values");if(i[3])throw new Error("Variable declaration '"+t+"' cannot have a transition");if(i[7])throw new Error("Variable declaration '"+t+"' cannot be !important");return e.$parser.addVariable(o,t,n,r)},window.fashion.$parser.parsePropertyValues=function(e,t,n){var i,r;if(-1!==e.indexOf(",")){if(e=window.fashion.$parser.splitByTopLevelCommas(e),1===e.length)return window.fashion.$parser.parsePropertyValue(e[0],t,n);for(i in e)r=e[i],e[i]=r.trim();for(i in e)r=e[i],e[i]=window.fashion.$parser.parsePropertyValue(r,t,n,!0,!0);return e}return window.fashion.$parser.parsePropertyValue(e,t,n)},window.fashion.$parser.parsePropertyValue=function(t,n,i,r,o){var a,s,u,l,d;if(null==r&&(r=!0),null==o&&(o=!1),o||"string"==typeof t&&-1!==t.indexOf(" ")){if(a=e.$parser.splitByTopLevelSpaces(t),!o&&1===a.length)return window.fashion.$parser.parseSingleValue(t,n,i);for(u=function(){var t,r,o;for(o=[],t=0,r=a.length;r>t;t++)s=a[t],o.push(e.$parser.parseSingleValue(s,n,i));return o}(),u.mode=0,l=0,d=u.length;d>l;l++)s=u[l],u.mode|=s.mode||0;return u}return window.fashion.$parser.parseSingleValue(t,n,i)},window.fashion.$parser.identifyExpression=function(){return/(([\s][\+\-\/\*\=][\s])|\s(\&\&|\|\|)\s|[\(\)\[\]]|\@|\$)/g},window.fashion.$parser.parseSingleValue=function(t,n,i){return t&&"string"==typeof t&&t.match(e.$parser.identifyExpression())?window.fashion.$parser.parseExpression(t,n,i,window.fashion.$functions,window.fashion.$globals):t},window.fashion.$parser.parseExpression=function(t,n,i,r,o,a){var s,u,d,c,p,h,f,w,m,v,g,b,y,$,S,x,I,F,O,E,N,M,P;for(null==a&&(a=!0),c=e.$parser.expressionExpander,w=window.fashion.$parser.matchParenthesis,b=t,m=e.$runtimeMode["static"],O=[],N=[],h=!1,y=0,g=function(t,n,i){return b=e.$parser.spliceString(b,t+y,n,i),y+=i.length-n},v=/(\$([\w\-]+)\s*?\=|\@(self|this|parent)\.?([^\s\)]*)|\$([\w\-]+)|\@([\w\-]+)|([\-]{0,1}([\.]\d+|\d+(\.\d+)*)[a-zA-Z]{1,4})|([\w\-\@\$]*)\(|\(|\)([\S]*))/g,S=!1;!S&&($=v.exec(t));)x=$.index,f=$[0].length,d=x+f,$[2]?(u=c.localVariable($[2],n,i,!0),h=!0):$[3]?u=c.relativeObject($[3],$[4]):$[5]?u=c.localVariable($[5],n,i):$[6]?u=c.globalVariable($[6],n,o,i):$[7]?u=c.numberWithUnit($[7]):$[10]&&(M=w(v,t,d),s=M.body,I=M.unit,s||(s=t.substring(d,t.length-1),S=!0),f+=s.length+1,I&&(f+=I.length),u=c["function"]($[10],s,I,n,i,r,o)),u&&(u.script&&g(x,f,u.script),u.mode&&(m|=u.mode),O.push(void 0===u.type?e.$type.Unknown:u.type),N.push(u.unit||""));return P=e.$parser.determineExpressionType(O,N),F=P.type,E=P.unit,h&&(E=void 0),b=e.$parser.wrapExpressionScript(b,a,F,E),p=new l(b,F,E,m),a&&p.generate(),p},window.fashion.$parser.wrapExpressionScript=function(e,t,n,i){return t?i&&"string"==typeof i?"return ("+e+") + '"+i+"'":"return "+e:"{value: "+e+", type: "+n+", unit: '"+i+"'}"},window.fashion.$parser.spliceString=function(e,t,n,i){return e.substr(0,t)+i+e.substr(t+n)},window.fashion.$parser.matchParenthesis=function(e,t,n){var i,r,o,a;for(r=0,i="",o=n;a=e.exec(t);)if(-1!==a[0].indexOf("("))r++;else{if(-1!==a[0].indexOf(")")&&0===r--)return i+=t.substr(o,a.index-o),{body:i,unit:a[11]};i+=t.substr(o,a.index-o+a[0].length),o=a.index+a[0].length}},window.fashion.$parser.determineExpressionType=function(t,n){var i,r,o,a,s;r=o=void 0;for(i in t)if(a=t[i],a!==e.$type.Unknown){if(r){if(a!==r){if(a!==e.$type.String)return console.log("[FASHION] Found mixed types in expression"),{};r=e.$type.String}}else r=a;if(a===e.$type.Number||a===e.$type.Color){if(s=n[i],""===s)continue;if(o){if(s!==o)return console.log("[FASHION] Conflicting units '"+s+"' and '"+typeUnit[1]+"'"),console.log("[FASHION] Unit conversion will be implemented in the future"),{}}else o=s}}return{type:r,unit:o}},window.fashion.$parser.expressionExpander={localVariable:function(t,n,i,r){var o,a,s,u,d,c,p,h,f,w;if(null==r&&(r=!1),w=i.variables,c=w[t],!c)return console.log("[FASHION] Variable $"+t+" does not exist.");o=!1,p=h=-1;for(d in c)f=c[d],0!==d&&(a=!1),p=f.type,h=f.unit;return r?u="v('"+t+"'"+(o?",e":"")+").value =":(i.addVariableBinding(n,t),u="v('"+t+"'"+(o?",e":"")+").value"),s=e.$runtimeMode.generate(!0,o),new l(u,p,h,s)},globalVariable:function(t,n,i,r){var o,a,s;return t=t.toLowerCase(),(s=i[t])?(r.addGlobalDependency(t,s),r.addGlobalBinding(n,t),o=e.$runtimeMode.dynamic,a="g."+t+".get()",new l(a,s.type,s.unit,o)):console.log("[FASHION] Variable $"+t+" does not exist.")},numberWithUnit:function(t){var n,i,r;return n=window.fashion.$type.Number,i=e.$runtimeMode["static"],r=window.fashion.$shared.getUnit(t,n,e.$type,e.$unit),0/0===r.value&&(r.value=0),new l(r.value,n,r.unit,i)},relativeObject:function(t,n){var i,r,o,a,s,u;return u="parent"===t?"e.parent":"e",i=n.split("."),r=i[i.length-1],"top"===r||"bottom"===r||"left"===r||"right"===r||"number"===r||"width"===r||"height"===r?(a=e.$type.Number,s="px"):a=e.$type.String,o=u,n&&(o+="."+n),new l(o,a,s,e.$runtimeMode.individual)},"function":function(e,t,n,i,r,o,a){var s,u,d,c,p,h,f,w,m,v,g,b;if(v=r.variables,p=o[e],!p)return console.log("[FASHION] Function $"+e+" does not exist.");for(t.length>1?(u=window.fashion.$parser.splitByTopLevelCommas(t),c=function(){var e,t,n;for(n=[],e=0,t=u.length;t>e;e++)s=u[e],n.push(window.fashion.$parser.parseExpression(s,i,r,o,a,!1));return n}()):c=[],w=["t"],h=p.mode,g=0,b=c.length;b>g;g++)d=c[g],d instanceof l&&(h|=d.mode,w.push(d.script));return m=""!==p.unit?p.unit:void 0!==p.unitFrom?c[p.unitFrom].unit:"",r.addFunctionDependency(e,p),f="f['"+e+"'].get.call("+w.join(",")+")",new l(f,p.type,n||m,h)}},window.fashion.$processor={process:function(t){return t=window.fashion.$processor.blocks(t,e.$blocks),t=window.fashion.$processor.properties(t,e.$properties)}},window.fashion.$processor.api={throwError:function(e,t){return console.log("[FASHION: "+e+"] "+t)},setProperty:function(t,n,i,r){var o;return o=new s(i,r,r.mode||e.$runtimeMode["static"]),t.insertProperty(o,n+1)},getProperty:function(e,t,n){var i;return i=void 0,e.forEachMatchingSelector(t,function(e){return e.forEachPropertyNamed(n,function(e){return i?!1:i=e.value}),i?!1:void 0}),i},addRule:function(t,n,i){var r;return r=e.$parser.createSelector(t,n),e.$parser.parseSelectorBody(i+"\n",r,t)},addScript:function(e,t){return e.addScript(t)},parseValue:function(t){return t&&"string"==typeof t?e.$parser.parseSingleValue(t):""},determineType:function(t){return t.type?t.type:"string"==typeof t?window.fashion.$shared.determineType(t,e.$type,e.$typeConstants):e.$type.Unknown},determineUnit:function(t){return t.unit?t.unit:"string"==typeof t?window.fashion.$shared.getUnit(t,e.$type.Number,e.$type,e.$unit).unit:""}},window.fashion.$processor.blocks=function(t,n){var i,r,o,a,s,u,l;for(a=window.fashion.$processor.api,l=t.blocks,s=0,u=l.length;u>s;s++)r=l[s],o=n[r.type],o&&(i={throwError:a.throwError.bind(0,r.type),addRule:a.addRule.bind(0,t),addScript:a.addScript.bind(0,t),parseValue:a.parseValue,parse:e.$parser.parse,runtimeObject:t.dependencies.blocks[r.type].runtimeObject},o.compile.call(i,r.arguments,r.body));return t},window.fashion.$processor.properties=function(t,n){var i,r,o,a,s,u,l,d,c,p,h,f;for(r=window.fashion.$processor.api,h=t.selectors,l=0,c=h.length;c>l;l++)for(u=h[l],o=-1,f=u.properties,d=0,p=f.length;p>d;d++)a=f[d],o++,s=n[a.name],s&&(i={throwError:r.throwError.bind(0,a),setProperty:r.setProperty.bind(0,u,o),getProperty:r.getProperty.bind(0,t,u.name),parseValue:r.parseValue,determineType:r.determineType,determineUnit:r.determineUnit},s.mode===e.$runtimeMode.individual?(t.addPropertyDependency(a.name,s),a.mode|=e.$runtimeMode.individual):(n[a.name].compile.call(i,a.value),s.replace&&u.properties.splice(o--,1)));return t},window.fashion.$shared={},window.fashion.$shared.getVariable=function(e,t,n,i,r,o){var a;return a=e[r],a?a[0]?a[0]:a.scope&&a.scope.length>0?this.throwError("Scoped variables are not yet supported"):a["default"]?a["default"].script?{value:this.evaluate(a["default"],e,t,n,i,o)}:{value:a["default"]}:this.throwError("Variable '"+r+"' does not exist."):(console.log("[FASHION] Could not find variable '"+r+"'"),{value:void 0})},window.fashion.$shared.evaluate=function(e,t,n,i,r,o){var a,s,u,l;return a=function(e){return function(a){var s,u,l,d,c,p;if("string"==typeof a)return a;if("number"==typeof a)return a;if(d=[],l=function(o,a){var s;return s=e.getVariable(t,n,i,r,o,a),d.push({name:o,object:s,value:s.value}),s},a.evaluate){if(u=a.evaluate(l,n,i,r,o),a.setter)for(c=0,p=d.length;p>c;c++)s=d[c],s.object.value!==s.value&&e.setVariable(s.name,s.object.value);return u}return a.value?a.value:void 0}}(this),e instanceof Array?0===e.length?"":e[0]instanceof Array?function(){var t,n,i;for(i=[],t=0,n=e.length;n>t;t++)l=e[t],i.push(function(){var e,t,n;for(n=[],e=0,t=l.length;t>e;e++)u=l[e],n.push(a(u));return n}().join(" "));return i}().join(", "):function(){var t,n,i;for(i=[],t=0,n=e.length;n>t;t++)s=e[t],i.push(a(s));return i}().join(" "):a(e)};var r=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};window.fashion.$shared.determineType=function(e,t,n){var i,o;return"number"==typeof e?t.Number:(o=function(e){return'"'===e[0]||"'"===e[0]?t.String:e.charCodeAt(0)>47&&e.charCodeAt(0)<58||"-"===e[0]||"."===e[0]?t.Number:"#"===e[0]||0===e.toLowerCase().indexOf("rgb")?t.Color:i(e)||window.fashion.$type.Unknown},i=function(e){return n?n.colors&&r.call(n.colors,e)>=0?t.Color:void 0:t.Unknown},o(e))},window.fashion.$shared.getUnit=function(e,t,n,i){var r;return"number"==typeof e?{value:parseFloat(e),unit:!1}:(r=function(){var t,n,r;return n=/([0-9\-\.]*)(.*?)/,t=n.exec(e),t.length<2?{value:parseFloat(e),unit:!1}:(r=e.replace(t[1],""),i=i.Number[r],i?{value:parseFloat(t[1]),unit:i}:{value:parseFloat(t[1]),unit:!1})},t===n.Number?r():(t===n.String&&("'"===e[0]||'"'===e[0])&&(e=e.substring(1,e.length-1)),{value:e,unit:void 0}))},window.fashion.$shared.timeInMs=function(e){return"ms"===e.unit?e.value:"s"===e.unit?1e3*e.value:0},window.fashion.color={cssTOjs:function(t,n){var i;return null==n&&(n=e.color),"#"===t[0]?n.hexTOrgb(t):(i=t.match(/rgba?\((.*?),(.*?),([^,]*),?(.*?)\)/))?{r:parseInt(i[1]),g:parseInt(i[2]),b:parseInt(i[3]),a:parseFloat(i[4]||1)}:void 0},hexTOrgb:function(e){var t,n;return void 0===e?{r:0,g:0,b:0}:(n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,e=e.replace(n,function(e,t,n,i){return t+t+n+n+i+i}),t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0})},rgbTOhex:function(e,t,n){var i,r;return"object"==typeof e&&(r=[e.r,e.g,e.b],e=r[0],t=r[1],n=r[2]),i=function(e){var t;return"string"==typeof e&&(e=parseInt(e)),t=e.toString(16),1===t.length?"0"+t:t},"#"+i(parseInt(e))+i(parseInt(t))+i(parseInt(n))},hsbTOrgb:function(e,t,n){var i,r,o;return"object"==typeof e&&(o=[e.h,e.s,e.b],e=o[0],t=o[1],n=o[2]),r=Math,t/=255,n/=255,i=function(i){return 255*(t*n*r.max(r.min(r.abs((e+i)/60%6-3)-1,1),0)+n*(1-t))},{r:i(0),g:i(240),b:i(120)}},rgbTOhsb:function(e,t,n){var i,r,o,a,s,u,l,d,c,p,h,f;if("object"==typeof e&&(c=[e.r,e.g,e.b],e=c[0],t=c[1],n=c[2]),d=Math.max(e,t,n),e/=255,t/=255,n/=255,o=Math.max(e,t,n),a=Math.min(e,t,n),o===a)return{h:0,s:0,b:d};switch(s=o-a,a){case e:p=[t-n,3],l=p[0],r=p[1];break;case t:h=[n-e,5],l=h[0],r=h[1];break;case n:f=[e-t,1],l=f[0],r=f[1]}return i=60*(r-l/s)%360,u=s/o*255,{h:i,s:u,b:d}}},window.fashion.$actualizer={actualize:function(t){var n,i,r,o,a,s,u,l,d,c,p,h,f;return d=e.$runtimeMode,e.$actualizer.separateTransitions(t),h=e.$actualizer.regroupProperties(t),p=h.selectors,s=h.map,f=e.$actualizer.cullIndividuality(p,s),o=f.sel,r=f.map,a=f.offsets,l=e.$actualizer.filterSelectors(o,d["static"]),c=e.$actualizer.generateRuntimeData(t,l,r),e.$actualizer.addBindings(c,t,l,r),n=e.$actualizer.determineRuntimeCapabilities(c,p),n.has(e.$runtimeCapability.individualProps)&&e.$actualizer.addIndividualProperties(c,p,a),e.$actualizer.addRuntimeFunctions(c,t,n),i=e.$actualizer.createCSS(c,o),u=e.$actualizer.createJS(c,t.scripts),{css:i,js:u}}},window.fashion.$actualizer.createJS=function(t,n){return"/*\\\n|*| GENERATED BY FASHION "+e.version+"\n|*| "+e.url+" - "+e.author+"\n\\*/\nwindow."+e.runtimeObject+" = "+e.$stringify(t)+";\nFSREADY = function(r){d=document;c=\"complete\";\n	if(d.readyState==c)r()\n	else d.addEventListener('readystatechange',function(){if(d.readyState==c)r()})\n}\n"+n.join("\n")},window.fashion.$actualizer.regroupProperties=function(t){var n,i,r,o,a,s,u,l,d,c,p,h;for(i=[],n=[],h=t.selectors,l=0,c=h.length;c>l;l++){for(o=h[l],r=o.properties,e.$actualizer.groupPropertiesWithMode(r,e.$runtimeMode.dynamic),e.$actualizer.groupPropertiesWithMode(r,e.$runtimeMode.live),e.$actualizer.groupPropertiesWithMode(r,e.$runtimeMode.individual),u=e.$actualizer.splitSelectorByModes(o),a=[],d=0,p=u.length;p>d;d++)s=u[d],i.push(s),a.push(i.length-1);n.push(a)}return{selectors:i,map:n}},window.fashion.$actualizer.groupPropertiesWithMode=function(e,t){var n,i,r,o,a,s,u,l,d,c;for(n=e[e.length-1].mode===t?1:0,c=[],a=l=d=e.length-2-n;l>=0;a=l+=-1)if(s=e[a],s.mode===t){for(o="-"===s.name[0]?2:0,u=s.name.split("-")[o].toLowerCase(),r=a+1;r<e.length-n&&(o="-"===e[r].name[0]?2:0,i=e[r].name.split("-")[o].toLowerCase(),i!==u);)r++;e.splice(a,1),e.splice(r-1,0,s),c.push(r===e.length-n?n++:void 0)}return c},window.fashion.$actualizer.splitSelectorByModes=function(e){var t,n,i,r,o,s;for(n=[],t=void 0,s=e.properties,r=0,o=s.length;o>r;r++)i=s[r],t&&t.mode===i.mode||(t=new a(e.name,i.mode),n.push(t)),t.addProperty(i);return n},window.fashion.$actualizer.cullIndividuality=function(t,n){var i,r,o,a,s,u,l,d,c,p,h,f,w,m;h={},c={},r={},i=0;for(o in t)f=t[o],f.mode===e.$runtimeMode.individual?(i++,r[o]=!0):(l=o-i,h[l]=f),c[o]=i;d=[],u=0;for(p in n)for(s=n[p],d.push([]),w=0,m=s.length;m>w;w++)a=s[w],d[p].push(r[a]===!0?"i"+u++:a-parseInt(c[a]));return{sel:h,map:d,offsets:c}},window.fashion.$actualizer.filterSelectors=function(e,t){var n,i,r;i={};for(n in e)r=e[n],r.mode!==t&&(i[n]=r);return i},window.fashion.$actualizer.addIndividualProperties=function(t,n,i){var r,o,a;a=[];for(r in n)o=n[r],o.mode===e.$runtimeMode.individual&&(o.index=r-i[r],a.push(t.addIndividualSelector(o)));return a};var g;g=function(){function t(t,n,i){var r,o,a;this.config=e.runtimeConfig,this.selectors=n,this.variables=i,this.modules=t.dependencies,a=this.modules.blocks;for(o in a)r=a[o],this.modules.blocks[o]=r.runtimeObject;this.runtime={}}return t.prototype.addIndividualSelector=function(e){return this.individual||(this.individual=[]),this.individual.push(e)},t.prototype.addRuntimeModule=function(e){var t,n,i;i=e.functions;for(n in i){if(t=i[n],this.runtime[n])return;this.runtime[n]=t}},t}();var b;b=function(){function e(e,t,n){this.name=e,this.type=t,this.unit=n,this.scopes=[],this.values={},this.dependents=[],this["default"]=void 0}return e.prototype.addScope=function(e,t){return this.values[e]=t,0===e||"0"===e?this["default"]=t:this.scopes.push(e)},e}(),window.fashion.$actualizer.generateRuntimeData=function(t,n,i){var r,o;return o=e.$actualizer.actualizeVariables(t,n,i),r=new g(t,n,o)},window.fashion.$actualizer.actualizeVariables=function(t,n,i){var r,o,a,s,u,l,d,c,p,h;p={},h=t.variables;for(d in h){s=h[d],u=l=-1;for(o in s)c=s[o],c.type&&(u=c.type),c.unit&&(l=c.unit);a=new b(d,u,l);for(o in s)c=s[o],a.addScope(o,c.value);r=t.bindings.variables[d],a.dependents=e.$actualizer.mapBindings(r,n,i),p[d]=a}return p},window.fashion.$actualizer.createCSS=function(t,n){var i,r,o,a,s,u,l,d,c,p,h,f;a=e.$actualizer.evaluationFunction(t),i="";for(s in n){for(l=n[s],r=[],f=l.properties,p=0,h=f.length;h>p;p++)u=f[p],c=u.value,o=a(l.mode===e.$runtimeMode["static"]?"object"==typeof c&&c.value?c.value:c:c),r.push(e.$actualizer.cssPropertyTemplate(u.name,o));d=a(l.name),i+=e.$actualizer.cssSelectorTemplate(d,r)}return i},window.fashion.$actualizer.cssPrefixes=["","-webkit-","-moz-","-ms-"],window.fashion.$actualizer.separateTransitions=function(t){var n,i,r,o,a,u,l,d,c,p,h,f,w,m,v,g,b;n=e.$actualizer.evaluationFunction(t.variables),u=window.fashion.$actualizer.cssPrefixes,v=t.selectors,b=[];for(i in v){for(c=v[i],f=[],g=c.properties,w=0,m=g.length;m>w;w++)l=g[w],l.value.transition&&(d=l.value.transition,d.property=l.name,f.push(d),d.mode=d.easing.mode|d.duration.mode|d.delay.mode);o=e.$runtimeMode,b.push(function(){var t,i,d,w;for(d=[o["static"],o.dynamic,o.individual,o.live],w=[],t=0,i=d.length;i>t;t++)r=d[t],h=e.$actualizer.transitionStrings(n,f,r),0!==h.length&&(p=h.join(","),l=new s("transition",p,r),w.push(function(){var e,t,n;
for(n=[],e=0,t=u.length;t>e;e++)a=u[e],n.push(c.addProperty(l.copyWithName(a+"transition")));return n}()));return w}())}return b},window.fashion.$actualizer.transitionStrings=function(t,n,i){var r,o,a,s,u,l,d;for(d=[],u=0,l=n.length;l>u;u++)s=n[u],s.mode===i&&(o=s.duration.script?t(s.duration):s.duration,a=s.easing.script?t(s.easing):s.easing,r=s.delay.script?t(s.delay):s.delay,d.push(e.$actualizer.cssTransitionTemplate(s.property,o,a,r)));return d},window.fashion.$actualizer.evaluationFunction=function(t){return function(n){return window.fashion.$shared.evaluate.call(window.fashion.$shared,n,t.variables,e.$globals,e.$functions,t.runtime)}},window.fashion.$actualizer.cssPropertyTemplate=function(e,t){return""+e+": "+t+";"},window.fashion.$actualizer.cssSelectorTemplate=function(e,t){return""+e+" {"+t.join("")+"}\n"},window.fashion.$actualizer.cssTransitionTemplate=function(e,t,n,i){return""+e+" "+(t||"1s")+" "+(n||"")+(i?" "+i:"")};var y,r=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};window.fashion.$runtimeCapability={variables:"variables",scopedVariables:"scopedVariables",individualProps:"individualized",liveProps:"liveProperties",globals:"globals"},y=function(){function e(){}return e.prototype.constuctor=function(){var e;return this.capabilities=function(){var t,n,i,r;for(i=window.fashion.runtimeModules,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(e);return r}()},e.prototype.add=function(e){var t;return this.capabilities||(this.capabilities=function(){var e,n,i,r;for(i=window.fashion.runtimeModules,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(t);return r}()),r.call(this.capabilities,e)>=0?void 0:this.capabilities.push(e)},e.prototype.addDependencies=function(e){var t,n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(this.add(t));return r},e.prototype.has=function(e){return this.capabilities?r.call(this.capabilities,e)>=0:!1},e}(),window.fashion.$actualizer.determineRuntimeCapabilities=function(t,n){var i,r,o,a,s;if(i=new y,"{}"!==JSON.stringify(t.variables))for(i.add(e.$runtimeCapability.variables),s=t.variables,o=0,a=s.length;a>o;o++)r=s[o],r.scopes.length>0&&i.add(e.$runtimeCapability.scopedVariables);return e.$actualizer.hasPropertyMode(n,e.$runtimeMode.individual)&&i.add(e.$runtimeCapability.individualProps),e.$actualizer.hasPropertyMode(n,e.$runtimeMode.live)&&i.add(e.$runtimeCapability.liveProps),"{}"!==JSON.stringify(t.modules.globals)&&i.add(e.$runtimeCapability.globals),e.$actualizer.addModuleCapabilities(i,t),i},window.fashion.$actualizer.hasPropertyMode=function(e,t){var n,i;for(n in e)if(i=e[n],i.mode===t)return!0;return!1},window.fashion.$actualizer.addRuntimeFunctions=function(t,n,i){var r,o,a,s,u,l,d,c;if(i.capabilities)for(r=0;r<i.capabilities.length;)if(u=i.capabilities[r++],void 0!==u){if(s=e.$runtimeModules[u],!s)return console.log("[FASHION] Could not find module "+u);if(i.addDependencies(s.dependencies),t.addRuntimeModule(s),s.initializers.length>0)for(c=s.initializers,l=0,d=c.length;d>l;l++)a=c[l],o="window."+e.runtimeObject+".runtime."+a+".bind(FASHION.runtime)",n.addScript("FSREADY("+o+");")}},window.fashion.$actualizer.addModuleCapabilities=function(e,t){var n,i,r,o,a,s,u;r=t.modules.blocks;for(i in r)n=r[i],n.runtimeCapabilities&&e.addDependencies(n.runtimeCapabilities);o=t.modules.properties;for(i in o)n=o[i],n.runtimeCapabilities&&e.addDependencies(n.runtimeCapabilities);a=t.modules.functions;for(i in a)n=a[i],n.runtimeCapabilities&&e.addDependencies(n.runtimeCapabilities);s=t.modules.globals,u=[];for(i in s)n=s[i],n.runtimeCapabilities&&u.push(e.addDependencies(n.runtimeCapabilities));return u},window.fashion.$actualizer.mapBindings=function(t,n,i){var r,o,a,s,u,l,d,c,p;for(o=[],u=0,d=t.length;d>u;u++)if(r=t[u],"string"==typeof r&&"$"===r[0])o.push(r);else for(p=i[r],l=0,c=p.length;c>l;l++)s=p[l],"number"==typeof s?(a=n[s],a&&a.mode!==e.$runtimeMode["static"]&&o.push(s)):o.push(s);return o},window.fashion.$actualizer.addBindings=function(t,n,i,r){return e.$actualizer.bindGlobals(t,n.bindings.globals,i,r)},window.fashion.$actualizer.bindGlobals=function(t,n,i,r){var o,a,s,u,l;u=t.modules.globals,l=[];for(s in u)a=u[s],o=n[s],l.push(a.dependents=e.$actualizer.mapBindings(o,i,r));return l};var $;$=function(){function e(e,t,n){var i,r;this.name=e,this.dependencies=t,this.functions=n,this.initializers=[];for(r in n)i=n[r],"$"===r[0]&&this.initializers.push(r)}return e}(),window.fashion.$runtimeModules={},window.fashion.addRuntimeModule=function(e,t,n){return window.fashion.$runtimeModules[e]=new $(e,t,n)},e.addRuntimeModule("types",[],{determineType:window.fashion.$shared.determineType,getUnit:window.fashion.$shared.getUnit,timeInMs:window.fashion.$shared.timeInMs}),e.addRuntimeModule("evaluation",["variables"],{evaluate_Shared:window.fashion.$shared.evaluate,evaluate:function(e,t){return this.evaluate_Shared(e,FASHION.variables,FASHION.modules.globals,FASHION.modules.functions,FASHION.runtime,t)}}),e.addRuntimeModule("colors",[],window.fashion.color),e.addRuntimeModule("errors",[],{throwError:function(e){return console.log("[FASHION] Runtime error: "+e),console.log((new Error).stack)}}),e.addRuntimeModule("variables",["evaluation","selectors","types","errors"],{getVariable:window.fashion.$shared.getVariable,variableValue:function(e,t){return this.getVariable(FASHION.variables,FASHION.modules.globals,FASHION.modules.functions,FASHION.runtime,e,t).value},updateVariable:function(e){var t,n;return(n=FASHION.variables[e])?(t=this.evaluate(n["default"]),this.setVariable(e,t)):this.throwError("Variable '$"+e+"' does not exist")},setVariable:function(e,t,n){return void 0===n?this.setTopLevelVariable(e,t):console.log("Scoped variable setting coming soon")},setTopLevelVariable:function(e,t){var n,i,r,o,a,s;if(i=FASHION.variables[e],!i)return this.throwError("Variable '$"+e+"' does not exist");for(i["default"]=t,a=i.dependents,s=[],r=0,o=a.length;o>r;r++)n=a[r],s.push("string"==typeof n&&"$"===n[0]?this.updateVariable(n.substr(1)):this.regenerateSelector(n));return s}}),e.addRuntimeModule("watchVariables",[],{$initWatchers:function(){var e,t,n,i,r,o;window[FASHION.config.variableObject]=t={},r=FASHION.variables,o=[];for(n in r)i=r[n],e=function(){return function(e){return{get:function(){return FASHION.runtime.variableValue(e)},set:function(t){return FASHION.runtime.setVariable(e,t)}}}}(this)(n),Object.defineProperty(t,n,e),o.push(Object.defineProperty(t,"$"+n,e));return o}}),e.addRuntimeModule("selectors",["evaluation","errors"],{runtimeModes:window.fashion.$runtimeMode,regenerateSelector:function(e){var t,n,i;return"string"==typeof e&&"i"===e[0]?(n=FASHION.individual[parseInt(e.substr(1))],n||this.throwError("Could not find individual property "+e),this.updateSelectorElements?(this.evaluate(n.name)!==n.elementsSelector&&this.updateSelectorElements(n),this.regenerateIndividualSelector(n)):this.throwError("The 'individualized' module was not included.")):(n=FASHION.selectors[e])?(t=document.getElementById(""+FASHION.config.cssId),i=t.sheet,i.deleteRule(e),i.insertRule(this.CSSRuleForSelector(n),e)):this.throwError("Selector "+e+" does not exist")},CSSPropertyTemplate:window.fashion.$actualizer.cssPropertyTemplate,CSSSelectorTemplate:window.fashion.$actualizer.cssSelectorTemplate,CSSRuleForSelector:function(e,t,n){var i,r,o,a,s,u;return s=n||this.evaluate(e.name,t),i=function(){var n,i,s,l;for(s=e.properties,l=[],n=0,i=s.length;i>n;n++){if(a=s[n],o=FASHION.modules.properties[a.name]){if(r=this.evaluate.bind(this,a.value,t),!o.apply)continue;if(o.apply(t,a.value,r),o.replace)continue}u=this.evaluate(a.value,t),l.push(this.CSSPropertyTemplate(a.name,u))}return l}.call(this),this.CSSSelectorTemplate(s,i)},addSelector:function(e,t){var n,i;return n=this.CSSRuleForSelector({name:e,properties:t}),i=document.getElementById(""+FASHION.config.cssId).sheet,i.insertRule(n,i.rules.length)}}),e.addRuntimeModule("individualized",["selectors","elements"],{$initializeIndividualProperties:function(){var e,t,n,i,r,o,a,s,u;for(t=document.createElement("style"),t.setAttribute("type","text/css"),t.setAttribute("id",""+FASHION.config.individualCSSID),document.head.appendChild(t),FASHION.individualSheet=t.sheet,a=FASHION.individual,n=0,r=a.length;r>n;n++)e=a[n],this.updateSelectorElements(e);for(s=FASHION.individual,u=[],i=0,o=s.length;o>i;i++)e=s[i],u.push(this.regenerateIndividualSelector(e));return u},updateSelectorElements:function(e){var t,n,i,r,o,a,s,u,l;u=e.elements;for(n in u)i=u[n],-1!==i.cssid&&FASHION.individualSheet.deleteRule(i.cssid);for(o=this.evaluate(e.name),e.elementsSelector=o,e.elements={},r=this.elementsForSelector(o),l=[],a=0,s=r.length;s>a;a++)t=r[a],t.id||t.setAttribute("id",this.generateRandomId()),l.push(e.elements[t.id]={element:t,cssid:-1});return l},generateRandomId:function(e){var t,n;return null==e&&(e=20),t=function(){var t,i;for(i=[],n=t=0;e>=0?e>=t:t>=e;n=e>=0?++t:--t)i.push(Math.round(36*Math.random()).toString(36));return i}().join(""),FASHION.config.idPrefix+t},elementsForSelector:function(e){return Array.prototype.slice.call(document.querySelectorAll(e))},regenerateIndividualSelector:function(e){var t,n,i,r,o,a;o=e.elements,a=[];for(i in o)r=o[i],-1!==r.cssid?FASHION.individualSheet.deleteRule(r.cssid):r.cssid=FASHION.individualSheet.rules.length,n=this.createElementObject(r.element),t=this.CSSRuleForSelector(e,n,"#"+i),a.push(FASHION.individualSheet.insertRule(t,r.cssid));return a}}),e.addRuntimeModule("elements",[],{createElementObject:function(e){var t,n,i,r,o,a;if(!e)return{};if(i={element:e},e.attributes)for(a=e.attributes,r=0,o=a.length;o>r;r++)t=a[r],i[t.name]=t.value;return Object.defineProperty(i,"parent",{get:function(t){return function(){return t.createElementObject(e.parentNode)}}(this)}),i.width=e.clientWidth,i.height=e.clientHeight,n=window.getComputedStyle(e),n&&(Object.defineProperty(i,"outerWidth",{get:function(){return parseFloat(n.marginLeft)+parseFloat(n.marginRight)+i.width}}),Object.defineProperty(i,"outerHeight",{get:function(){return parseFloat(n.marginTop)+parseFloat(n.marginBottom)+i.height}})),i.addEventListener=function(t,n,i){return e.addEventListener(t,n,i)},i}}),e.addRuntimeModule("globals",["selectors"],{$startWatchers:function(){var e,t,n,i,r;n=function(e){return function(t){return e.updateGlobal.bind(e,t)}}(this),i=FASHION.modules.globals,r=[];for(t in i)e=i[t],e.watch(n(e)),r.push(this.updateGlobal(e));return r},updateGlobal:function(e){var t,n,i,r,o;for(r=e.dependents,o=[],n=0,i=r.length;i>n;n++)t=r[n],o.push(this.regenerateSelector(t));return o}}),window.fashion.$functions={random:new c({output:e.$type.Number,evaluate:function(){return Math.random()}}),round:new c({output:e.$type.Number,unitFrom:0,evaluate:function(e){return Math.round(e.value)}}),min:new c({output:e.$type.Number,unitFrom:0,evaluate:function(){var e,t,n,i;for(t=9007199254740992,n=0,i=arguments.length;i>n;n++)e=arguments[n],e.value<t&&(t=e.value);return t}}),max:new c({output:e.$type.Number,unitFrom:0,evaluate:function(){var e,t,n,i;for(t=-9007199254740992,n=0,i=arguments.length;i>n;n++)e=arguments[n],e.value>t&&(t=e.value);return t}})},e.$extend(window.fashion.$functions,{"@":new c({output:e.$type.Number,unit:"",dynamic:!0,evaluate:function(e,t,n){var i,r;return n||(n=document),i=this.querySelector(e.value),r=this.getComputedStyle(i),r[t.value]}})}),e.$extend(window.fashion.$functions,{rgb:new c({output:e.$type.Color,evaluate:function(e,t,n){return"rgb("+parseInt(e.value)+","+parseInt(t.value)+","+parseInt(n.value)+")"}}),rgba:new c({output:e.$type.Color,evaluate:function(e,t,n,i){return"rgba("+parseInt(e.value)+","+parseInt(t.value)+","+parseInt(n.value)+","+i.value+")"}})}),window.fashion.$properties={"text-style":new f({replace:!0,compile:function(e){var t,n,i,r,o;if(n=[],t=function(e){return function(t){if("string"==typeof t){if("'"===t[0]||'"'===t[0])return n.push(t);switch(t){case"serif":return n.push("serif");case"sans-serif":return n.push("sans-serif");case"monospace":return n.push("monospace");case"italic":return e.setProperty("font-style","italic");case"oblique":return e.setProperty("font-style","oblique");case"bold":return e.setProperty("font-weight","bolder");case"light":return e.setProperty("font-weight","lighter");case"underline":return e.setProperty("text-decoration","underline");case"overline":return e.setProperty("text-decoration","overline");case"line-through":return e.setProperty("text-decoration","line-through");case"strikethrough":return e.setProperty("text-decoration","line-through")}}}}(this),e instanceof Array)for(r=0,o=e.length;o>r;r++)i=e[r],t(i);else t(e);return this.setProperty("font-family",n.join(", "))}})},e.$extend(window.fashion.$properties,{pin:new f({replace:!0,compile:function(e){var t,n,i,r,o;return"object"==typeof e&&(e.length>2||e[0]instanceof Array)&&this.throwError("Valid arguments: '{x}px {y}px' or '{both}px'"),this.setProperty("position","absolute"),n=r=o=t=void 0,i=function(e){switch(e){case"left":return n="0px";case"right":return r="0px";case"top":return o="0px";case"bottom":return t="0px";case"center":return n="@parent.width / 2 - @self.outerWidth / 2",o="@parent.height / 2 - @self.outerHeight / 2";default:return this.throwError("Invalid position: "+e)}},"object"==typeof e?(i(e[0]),2===e.length&&i(e[1])):"string"==typeof e&&i(e),n?this.setProperty("left",this.parseValue(n)):this.setProperty("right",this.parseValue(r)),o?this.setProperty("top",this.parseValue(o)):this.setProperty("bottom",this.parseValue(t))}})}),e.$extend(window.fashion.$properties,new(function(){function t(){var t,n,i,r,o;for(n=["click","dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","mouseout","mouseover","drag","dragdrop","dragend","drop","dragenter","dragexit","draggesture","dragleave","dragover","dragstart","blur","change","focus","focusin","focusout","submit","reset"],t=function(e){var t;return t="element.addEventListener('"+e+"', evaluate, false);",new Function("element","value","evaluate",t)},r=0,o=n.length;o>r;r++)i=n[r],this["on-"+i]=new f({replace:!0,mode:e.$runtimeMode.individual,apply:t(i)})}return t}())),window.fashion.$blocks={},window.fashion.$blocks.transition=new d({capabilities:["selectors","evaluation"],compile:function(e,t){var n,i,r,o,a,s,u,l,d,c,p;for(l=e[0],d=/(\s*([0-9\-\.\s\%]+?\%|start)\s?\{|\}|\{)/g,s={},o=u=0,r=n="",i=1e3;--i>0&&(c=d.exec(t));)n+=t.substring(u,c.index),u=c.index,c[2]&&0===o&&(r=c[2],n="",u=c[0].length+c.index,o++),"{"===c[0]?o++:"}"===c[0]&&(o--,0===o&&(s[r]=n,n="",r=""));p={};for(a in s)t=s[a],p[a]=this.parse(t).selectors;return this.runtimeObject.transitions[l]=p},runtimeObject:{transitions:{},startDelay:10,endDelay:2,settleDelay:1,wait:function(e,t){return setTimeout(t,e)},trigger:function(e,t){var n,i,r,o,a,s,u,l,d,c,p;t=this.timeInMs(t),s=FASHION.modules.blocks.transition,p=s.transitions[e],d=document.createElement("style"),d.setAttribute("type","text/css"),r=document.head||document.getElementsByTagName("head")[0],r.appendChild(d),l=d.sheet;for(a in p)u=p[a],"start"===a?c=0:(o=parseFloat(a.split("-")[0])/100*t,c=o+s.startDelay),n=s.addSelectorsFunc(u,t,l,s),c>0?s.wait(c,n.bind(this)):n.bind(this)();return i=t+s.startDelay+s.endDelay,s.wait(i,function(){return d.parentElement.removeChild(d)})},addSelectorsFunc:function(e,t,n,i){return function(){var r,o,a,s,u,l,d,c,p,h,f,w;d=FASHION.modules.blocks.transition.settleDelay;for(r in e){for(l=e[r],a=l.properties,o=[],p=[],c=0,f=0,w=a.length;w>f;f++)s=a[f],"object"==typeof s.value&&s.value.transition?(p.push(s),c++):o.push(s);this.addSelector(l.name,o),0!==c&&(h=i.generateTransitions.call(this,p,t),u=this.evaluate(l.name),n.insertRule(""+u+" {"+h+"}",n.rules.length),i.wait(d,function(e){return function(t,n){return function(){return e.addSelector(t.name,n)}}}(this)(l,p)))}}},generateTransitions:function(e,t){var n,i,r,o,a,s,u;for(n="transition: ",s=0,u=e.length;u>s;s++)o=e[s],o.value.transition&&(a=o.value.transition,i=parseFloat(this.evaluate(a.duration))/100*t,r=i?""+i+"ms":a.duration,n+=""+o.name+" "+r+" "+(a.easing||"")+" "+(a.delay||"")+",");return n=n.substr(0,n.length-1)+";",n=[n,"-webkit-"+n,"-moz-"+n,"-ms-"+n].join("")}}}),window.fashion.$functions.trigger=new c({output:e.$type.None,unit:"",mode:e.$runtimeMode.individual,evaluate:function(e,t,n){var i;return i=FASHION.modules.blocks.transition.trigger,i.call(this,e.value,t,n)}}),window.fashion.$globals={width:new p({type:e.$type.Number,unit:"px",get:function(){return window.innerWidth},watch:function(e){return window.addEventListener("resize",e,!1)}}),height:new p({type:e.$type.Number,unit:"px",get:function(){return window.innerHeight},watch:function(e){return window.addEventListener("resize",e,!1)}}),scrolly:new p({type:e.$type.Number,unit:"px",get:function(){return window.scrollY},watch:function(e){return window.addEventListener("onscroll",e)}}),scrollx:new p({type:e.$type.Number,unit:"px",get:function(){return window.scrollX},watch:function(e){return window.addEventListener("onscroll",e)}}),mousey:new p({type:e.$type.Number,unit:"px",get:function(){return window.mouseY||0},watch:function(e){return window.addEventListener("mousemove",function(t){return window.mouseY=t.pageY,e()})}}),mousex:new p({type:e.$type.Number,unit:"px",get:function(){return window.mouseX||0},watch:function(e){return window.addEventListener("mousemove",function(t){return window.mouseX=t.pageX,e()})}})}}();
